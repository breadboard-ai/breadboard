{
  "title": "MCP Server",
  "description": "",
  "version": "0.0.1",
  "nodes": [],
  "edges": [],
  "metadata": {
    "icon": "generative",
    "visual": {
      "presentation": {
        "themes": {
          "f65ea9aa-b8c6-4c80-9667-a08c4f631013": {
            "themeColors": {
              "primaryColor": "#246db5",
              "secondaryColor": "#5cadff",
              "backgroundColor": "#ffffff",
              "textColor": "#1a1a1a",
              "primaryTextColor": "#ffffff"
            },
            "template": "basic",
            "splashScreen": {
              "storedData": {
                "handle": "/images/app/generic-flow.jpg",
                "mimeType": "image/jpeg"
              }
            }
          }
        },
        "theme": "f65ea9aa-b8c6-4c80-9667-a08c4f631013"
      }
    },
    "userModified": true,
    "tags": [
      "connector",
      "connector-singleton",
      "experimental",
      "published"
    ],
    "comments": [
      {
        "id": "comment-c74afa15",
        "text": "Intentionally Left Blank",
        "metadata": {
          "title": "Comment",
          "visual": {
            "x": 281,
            "y": 501,
            "collapsed": "expanded",
            "outputHeight": 0
          }
        }
      }
    ]
  },
  "modules": {
    "configurator": {
      "code": "/**\n * @fileoverview Add a description for your module here.\n */\nimport { createConfigurator } from \"./a2/connector-manager\";\nimport { llm } from \"./a2/utils\";\nexport { invoke as default, describe };\nconst CONNECTOR_TITLE = \"MCP Server\";\nconst { invoke, describe } = createConfigurator({\n    title: CONNECTOR_TITLE,\n    initialize: async () => {\n        return { title: CONNECTOR_TITLE, configuration: {} };\n    },\n    preview: async (_caps, { configuration }) => {\n        const endpoint = configuration.endpoint;\n        if (!endpoint) {\n            return [llm ``.asContent()];\n        }\n        return [llm `${endpoint}`.asContent()];\n    },\n    read: async (_caps, { configuration }) => {\n        return {\n            schema: {\n                type: \"object\",\n                properties: {\n                    endpoint: {\n                        type: \"string\",\n                        title: \"URL\",\n                        description: \"The URL of the MCP Server's Streamable HTTP endpoint\",\n                    },\n                },\n            },\n            values: configuration,\n        };\n    },\n});\n"
    },
    "connector-tools": {
      "code": "/**\n * @fileoverview The tools export for the connector.\n */\nimport { createTools } from \"./a2/connector-manager\";\nimport { StreamableReporter } from \"./a2/output\";\nimport { err, ok } from \"./a2/utils\";\nimport { McpClient } from \"./mcp-client\";\nexport { invoke as default, describe };\nconst NOT_ALLOWED_MARKER = \"\\nMCP_SERVER_NOT_ALLOWED\";\nfunction isNotAllowed(error) {\n    return error.$error.includes(NOT_ALLOWED_MARKER);\n}\nconst { invoke, describe } = createTools({\n    title: \"MCP Server\",\n    list: async (caps, _id, info) => {\n        const reporter = new StreamableReporter(caps, {\n            title: `Calling MCP Server`,\n            icon: \"robot_server\",\n        });\n        try {\n            await reporter.start();\n            await reporter.sendUpdate(\"MCP Server Request\", { listTools: {} }, \"upload\");\n            const client = new McpClient(caps, {\n                url: info.configuration.endpoint,\n                info: {\n                    name: \"Breadboard\",\n                    title: \"Breadboard\",\n                    version: \"0.0.1\",\n                },\n            });\n            const listingTools = await client.listTools();\n            if (!ok(listingTools)) {\n                if (isNotAllowed(listingTools)) {\n                    return reporter.sendError(err(`\"${info.configuration.endpoint} is not an allowed MCP Server`));\n                }\n                return reporter.sendError(listingTools);\n            }\n            await reporter.sendUpdate(\"MCP Server Response\", listingTools, \"download\");\n            // Transform to the ToolManager format.\n            const list = listingTools.map((item) => {\n                return {\n                    url: info.url,\n                    description: { ...item, title: item.name },\n                    passContext: false,\n                };\n            });\n            return { list };\n        }\n        finally {\n            await reporter.close();\n        }\n    },\n    invoke: async (caps, _id, info, name, args) => {\n        const reporter = new StreamableReporter(caps, {\n            title: `Calling MCP Server`,\n            icon: \"robot_server\",\n        });\n        try {\n            await reporter.start();\n            await reporter.sendUpdate(\"MCP Server Request\", { callTool: { name, arguments: args } }, \"upload\");\n            const client = new McpClient(caps, {\n                url: info.configuration.endpoint,\n                info: {\n                    name: \"Breadboard\",\n                    title: \"Breadboard\",\n                    version: \"0.0.1\",\n                },\n            });\n            const callingTool = await client.callTool({\n                name,\n                arguments: args,\n            });\n            if (!ok(callingTool)) {\n                if (isNotAllowed(callingTool)) {\n                    return reporter.sendError(err(`\"${info.configuration.endpoint} is not an allowed MCP Server`));\n                }\n                return reporter.sendError(callingTool);\n            }\n            await reporter.sendUpdate(\"MCP Server Response\", callingTool, \"download\");\n            return { result: JSON.stringify(callingTool) };\n        }\n        finally {\n            await reporter.close();\n        }\n    },\n});\n"
    },
    "mcp-client": {
      "code": "/**\n * @license\n * Copyright 2025 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { RpcSession } from \"./a2/rpc\";\nexport { McpClient };\nclass McpClient extends RpcSession {\n    constructor(caps, args) {\n        super(caps, \"/mnt/mcp/session\");\n        this.args = args;\n    }\n    createSessionKey() {\n        return this.args.url;\n    }\n    getInitArgs() {\n        return this.args;\n    }\n    async listTools() {\n        return this.call(\"listTools\", {});\n    }\n    async callTool(args) {\n        return this.call(\"callTool\", args);\n    }\n}\n"
    },
    "types": {
      "code": "/**\n * @license\n * Copyright 2025 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\nexport {};\n"
    }
  },
  "imports": {
    "a2": {
      "url": "./a2.bgl.json"
    }
  },
  "exports": [
    "#module:configurator",
    "#module:connector-tools"
  ]
}